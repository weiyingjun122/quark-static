<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>夸克网盘资源搜索</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    text-align: center;
  }
  .logo {
    margin-top: 80px;
  }
  .logo img {
    width: 120px;
  }
  .logo h1 {
    font-size: 28px;
    margin: 10px 0 40px;
  }
  .search-box {
    display: flex;
    justify-content: center;
    margin-bottom: 50px;
  }
  .search-box input {
    width: 400px;
    padding: 12px 16px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 24px 0 0 24px;
    outline: none;
  }
  .search-box button {
    padding: 12px 24px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-left: none;
    border-radius: 0 24px 24px 0;
    background-color: #4CAF50;
    color: #fff;
    cursor: pointer;
  }
  .search-box button:hover {
    background-color: #45a049;
  }

  /* 弹窗样式 */
  #modalOverlay {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.5);
    justify-content: center;
    align-items: center;
    z-index: 999;
  }
  #modalContent {
    background: #fff;
    padding: 30px;
    max-width: 600px;
    width: 90%;
    border-radius: 12px;
    overflow-y: auto;
    max-height: 80%;
    text-align: center;
  }
  .resource-item {
    margin-bottom: 25px;
  }
  .resource-item h3 {
    font-size: 18px;
    margin-bottom: 10px;
  }
  .resource-item img {
    max-width: 200px;
    border: 1px solid #ccc;
    border-radius: 12px;
  }
  .resource-item button {
    padding: 10px 20px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    background-color: #2196F3;
    color: #fff;
    cursor: pointer;
  }
  .resource-item button:hover {
    background-color: #0b7dda;
  }
  .no-result img {
    width: 200px;
    margin-top: 15px;
    border-radius: 12px;
  }
</style>
</head>
<body>

<div class="logo">
  <img src="static/logo.png" alt="夸克网盘">
  <h1>夸克网盘资源搜索</h1>
</div>

<div class="search-box">
  <input type="text" id="searchInput" placeholder="输入资源关键词搜索...">
  <button onclick="search()">搜索</button>
</div>

<!-- 弹窗 -->
<div id="modalOverlay">
  <div id="modalContent"></div>
</div>

<script>
let resources = [];
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

// 加载 data.json
fetch('data.json')
  .then(response => response.json())
  .then(data => { resources = data; })
  .catch(err => console.error('加载资源数据失败:', err));

function search() {
  const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
  const results = resources.filter(item =>
    item.title?.toLowerCase().includes(keyword) ||
    item.keywords?.some(k => k.toLowerCase().includes(keyword))
  );

  const modalContent = document.getElementById('modalContent');
  modalContent.innerHTML = '';

  if (results.length > 0) {
    results.forEach(item => {
      const div = document.createElement('div');
      div.className = 'resource-item';
      div.innerHTML = `<h3>${item.title}</h3>`;
      if (isMobile) {
        div.innerHTML += `<button onclick="window.open('${item.share_link}', '_blank')">打开链接</button>`;
      } else {
        div.innerHTML += `<img src="${item.qrcode}" alt="${item.title}">`;
      }
      modalContent.appendChild(div);
    });
  } else {
    modalContent.innerHTML = `
      <h2>未找到资源</h2>
      <div class="no-result">
        <p>加入微信群获取资源</p>
        <img src="static/wechat_qrcode.png" alt="微信群二维码">
      </div>
    `;
  }

  document.getElementById('modalOverlay').style.display = 'flex';
}

// 点击遮罩关闭弹窗
document.getElementById('modalOverlay').addEventListener('click', function(e) {
  if (e.target === this) {
    this.style.display = 'none';
  }
});
</script>

</body>
</html>
